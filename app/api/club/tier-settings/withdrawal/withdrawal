
import { PrismaClient } from '@prisma/client';
import tiers from './../../../../lib/utils';

const prisma = new PrismaClient();

export default async function handler(req, res) {
    if (req.method !== 'POST') return res.status(405).end();

    const { userId, isusuGroupId, amount } = req.body;

    // Get Isusu group and tier settings
    const group = await prisma.isusu.findUnique({ where: { id: isusuGroupId } });
    if (!group) return res.status(404).json({ message: "Group not found" });

    const tierSettings = tiers.find(t => t.name === group.tier);

    // Restrict withdrawals if not allowed
    if (!tierSettings || tierSettings.permissions.withdrawals === "Limited") {
        return res.status(403).json({ message: "Withdrawals are restricted for this tier" });
    }

    // Process withdrawal logic here...
    res.json({ success: true, message: "Withdrawal successful" });
}



































































































































































